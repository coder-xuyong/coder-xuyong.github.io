---
title: mysql å¸¸è§é”™è¯¯æ±‡æ€»
icon: pen-to-square
date: 2025-01-13
cover: https://fastcdn.mihoyo.com/content-v2/hk4e/127622/e03b719f827eba22de2b3e4de1778f19_443214802071996334.png
lastUpdated: true
author: 
    - name: xuyong
      url: https://github.com/coder-xuyong
category:
  - mysql

tag:
  - sql
order: 98
permalinkPattern: :year/:month/:day/:slug.html
---



## MySQL é”™è¯¯å‰–æž
æ¯ä¸ª MySQL é”™è¯¯éƒ½ç”±æ ‡è¯†é”™è¯¯çš„ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼š

`ERROR NUMBER` æ˜¯æ ‡è¯†æ¯ä¸ªé”™è¯¯çš„å”¯ä¸€ç¼–å·ã€‚
`SQLSTATE` æ˜¯æ ‡è¯† SQL é”™è¯¯æƒ…å†µçš„ä»£ç ã€‚
`ERROR MESSAGE` ä»¥äººç±»å¯è¯»çš„æ ¼å¼æè¿°é”™è¯¯ã€‚
ä¸‹é¢æ˜¯ä¸€ä¸ª MySQL é”™è¯¯ç¤ºä¾‹ï¼š
```shell
ERROR 1146 (42S02): Table 'test.no_such_table' doesn't exist
```
åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼š

- 1146 æ˜¯é”™è¯¯å·
- 42S02 æ˜¯ SQLSTATE
- è¡¨ 'test.no_such_table' ä¸å­˜åœ¨æ˜¯é”™è¯¯æ¶ˆæ¯

## ç”¨æˆ· 'root'@'localhost' çš„è®¿é—®è¢«æ‹’ç»ï¼ˆä½¿ç”¨å¯†ç ï¼šYESï¼‰
```shell
ERROR 1045: Access denied for user 'root'@'localhost'
```
ä»»ä½•ä½¿ç”¨ MySQL çš„äººéƒ½å¯èƒ½è‡³å°‘é‡åˆ°è¿‡ä¸€æ¬¡ã€‚
æ­¤é”™è¯¯å¯èƒ½æœ‰å¤šç§åŽŸå› ï¼Œä¾‹å¦‚ç”¨æˆ·åå’Œ/æˆ–å¯†ç é”™è¯¯ï¼Œæˆ–ç¼ºå°‘å¯¹æ•°æ®åº“çš„æƒé™ã€‚

æ­¤é”™è¯¯è¡¨ç¤º MySQL æœåŠ¡å™¨åœ¨å°è¯•ä½¿ç”¨æä¾›çš„å¯†ç ä»Ž 'localhost' æœåŠ¡å™¨è¿›è¡Œè¿žæŽ¥æ—¶æ‹’ç»äº†å¯¹ 'root' ç”¨æˆ·çš„è®¿é—®ã€‚

ðŸ’¡è¦è§£å†³æ­¤é—®é¢˜ï¼Œè¯·ä»”ç»†æ£€æŸ¥å¯†ç å¹¶ç¡®ä¿ç”¨æˆ·å…·æœ‰å¿…è¦çš„æƒé™ã€‚
æ‚¨å¯ä»¥é‡ç½®å¯†ç æˆ–æŽˆäºˆè§£å†³æ­¤é—®é¢˜æ‰€éœ€çš„æƒé™ã€‚
## Lost connection to MySQL server during query
```shell
ERROR 2013: Lost connection to MySQL server during query
```
å½“æ‚¨çš„ MySQL å®¢æˆ·ç«¯å’Œæ•°æ®åº“æœåŠ¡å™¨ä¹‹é—´çš„è¿žæŽ¥è¶…æ—¶æ—¶ï¼Œä¼šå‘ç”Ÿæ­¤é”™è¯¯ã€‚
ä»Žæœ¬è´¨ä¸Šè®²ï¼ŒæŸ¥è¯¢è¿”å›žæ•°æ®èŠ±è´¹çš„æ—¶é—´å¤ªé•¿ï¼Œå› æ­¤è¿žæŽ¥è¢«æ–­å¼€ã€‚
è¿™å¯èƒ½æ˜¯ç”±äºŽå„ç§åŽŸå› é€ æˆçš„ï¼Œä¾‹å¦‚ç½‘ç»œé—®é¢˜æˆ–æœåŠ¡å™¨è¶…æ—¶ã€‚

ðŸ’¡ è¦è§£å†³æ­¤é—®é¢˜ï¼Œè¯·è€ƒè™‘è°ƒæ•´ MySQL æœåŠ¡å™¨é…ç½®ä»¥å¢žåŠ è¿žæŽ¥è¶…æ—¶å€¼æˆ–è°ƒæŸ¥ç½‘ç»œç¨³å®šæ€§ã€‚
## Too many connections
```shell
ERROR 1040: Too many connections
```
å½“ MySQL æœåŠ¡å™¨è¾¾åˆ°å…¶å…è®¸çš„æœ€å¤§è¿žæŽ¥æ•°é™åˆ¶æ—¶ï¼Œä¼šå‡ºçŽ°æ­¤é”™è¯¯ã€‚

ðŸ’¡ è¦è§£å†³æ­¤é—®é¢˜ï¼Œæ‚¨å¯ä»¥å¢žåŠ  MySQL é…ç½®æ–‡ä»¶ä¸­çš„ max_connections è®¾ç½®ï¼Œæˆ–è€…ä¼˜åŒ–åº”ç”¨ç¨‹åºä»¥ä½¿ç”¨æ›´å°‘çš„è¿žæŽ¥ã€‚
## MySQL server has gone away
```shell
ERROR 2006 (HY000): MySQL server has gone away
```
æ­¤é”™è¯¯è¡¨ç¤º MySQL æœåŠ¡å™¨æ„å¤–ç»ˆæ­¢äº†è¿žæŽ¥ã€‚
è¿™å¯èƒ½æ˜¯ç”±äºŽå„ç§åŽŸå› é€ æˆçš„ï¼ŒåŒ…æ‹¬é•¿æ—¶é—´è¿è¡Œçš„æŸ¥è¯¢æˆ–æœåŠ¡å™¨è¶…æ—¶ã€‚

ðŸ’¡ è¦é˜²æ­¢è¿™ç§æƒ…å†µï¼Œæ‚¨å¯ä»¥åœ¨ MySQL é…ç½®ä¸­è°ƒæ•´ wait_timeout å’Œ interactive_timeout è®¾ç½®ã€‚
## MySQL client ran out of memory
```shell
ERROR 2008: MySQL client ran out of memory
```
å½“ MySQL å®¢æˆ·ç«¯æ¶ˆè€—çš„å†…å­˜è¶…è¿‡å¯ç”¨å†…å­˜æ—¶ï¼Œä¼šå‘ç”Ÿæ­¤é”™è¯¯ã€‚

ðŸ’¡ è¦è§£å†³æ­¤é—®é¢˜ï¼Œæ‚¨å¯èƒ½éœ€è¦ä¼˜åŒ–æŸ¥è¯¢ã€é™åˆ¶ç»“æžœé›†æˆ–ä¸º MySQL å®¢æˆ·ç«¯åˆ†é…æ›´å¤šå†…å­˜ã€‚
## The table is full
```shell
ERROR 1114 (HY000): The table is full
```
å¦‚æžœå‘ç”Ÿ table-full é”™è¯¯ï¼Œåˆ™å¯èƒ½æ˜¯ç£ç›˜å·²æ»¡æˆ–è¡¨å·²è¾¾åˆ°å…¶æœ€å¤§å¤§å°ã€‚
MySQL æ•°æ®åº“çš„æœ‰æ•ˆæœ€å¤§è¡¨å¤§å°é€šå¸¸ç”±æ“ä½œç³»ç»Ÿå¯¹æ–‡ä»¶å¤§å°çš„é™åˆ¶å†³å®šï¼Œè€Œä¸æ˜¯ç”± MySQL å†…éƒ¨é™åˆ¶å†³å®šã€‚

ðŸ’¡ è¦è§£å†³æ­¤é—®é¢˜ï¼Œæ‚¨å¯ä»¥ï¼š

- å¢žåŠ  MEMORY è¡¨å…è®¸çš„æœ€å¤§å¤§å°
```shell
[mysqld]
max_heap_table_size = 2G
tmp_table_size = 2G
```
- åˆ‡æ¢åˆ° InnoDB å­˜å‚¨å¼•æ“Ž
- æ£€æŸ¥ç£ç›˜ç©ºé—´å¹¶å¢žåŠ å¯ç”¨ç©ºé—´ï¼š
## You have an error in your SQL syntax
```shell
ERROR 1064 (42000): You have an error in your SQL syntax
```
è¿™æ„å‘³ç€ MySQL ç”±äºŽè¯­æ³•é—®é¢˜è€Œæ— æ³•ç†è§£æ‚¨çš„æŸ¥è¯¢ã€‚é€šå¸¸ï¼Œé—®é¢˜çš„åŽŸå› æ˜¯å¿˜è®°å°†æŸäº›æ–‡æœ¬æˆ–å€¼æ‹¬åœ¨åå¼•å·æˆ–å¼•å·ä¸­ã€‚ä¾‹å¦‚ï¼Œè€Œä¸æ˜¯åœ¨ MySQL æŸ¥è¯¢ä¸­ä½¿ç”¨æ•°æ®åº“åç§°ï¼Œå› ä¸ºå®ƒåº”è¯¥æ˜¯ ã€‚my-database`my-database`

é”™è¯¯æ¶ˆæ¯ç”šè‡³ä¼šæ›´è¿›ä¸€æ­¥ï¼Œå¹¶æŒ‡å‡ºè¯­æ³•å¼€å§‹æ— æ•ˆçš„ä½ç½®ï¼Œæ‚¨å¯ä»¥å°†å…¶ç”¨ä½œå¯»æ‰¾é—®é¢˜çš„èµ·ç‚¹ã€‚

ðŸ’¡ ä»”ç»†æ£€æŸ¥æ‚¨çš„æŸ¥è¯¢ï¼Œç¡®ä¿æ‰€æœ‰ SQL è¯­å¥çš„æ ¼å¼æ­£ç¡®å¹¶éµå¾ª MySQL çš„è¯­æ³•è§„åˆ™ã€‚
## Packet too large
```shell
ERROR: Packet too large
```
å½“ MySQL å®¢æˆ·ç«¯æˆ– mysqld æœåŠ¡å™¨èŽ·å–çš„æ•°æ®åŒ…å¤§äºŽmax_allowed_packetå­—èŠ‚ï¼Œå®ƒä¼šå‘å‡º Packet too large é”™è¯¯å¹¶å…³é—­è¿žæŽ¥ã€‚

1 GB æ•°æ®åŒ…å¤§å°æ˜¯å¯ä»¥ä¼ è¾“åˆ° MySQL æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯æˆ–ä»Ž MySQL æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯ä¼ è¾“çš„æœ€å¤§æ•°æ®åŒ…å¤§å°ã€‚å¦‚æžœ MySQL æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯æ”¶åˆ°å¤§äºŽ max_allowed_packet å­—èŠ‚çš„æ•°æ®åŒ…ï¼Œåˆ™å‘å‡º ER_NET_PACKET_TOO_LARGE é”™è¯¯å¹¶å…³é—­è¿žæŽ¥ã€‚

ðŸ’¡ æ‚¨å¯ä»¥é€šè¿‡è°ƒæ•´ MySQL é…ç½®æ–‡ä»¶ä¸­çš„ max_allowed_packet è®¾ç½®æ¥è§£å†³æ­¤é—®é¢˜ã€‚
## Communication Errors and Aborted Connections
```shell
ERROR: Communication Errors and Aborted Connections
```
å¦‚æžœæ‚¨åœ¨é”™è¯¯æ—¥å¿—ä¸­å‘çŽ°å¦‚ä¸‹é”™è¯¯ã€‚
```shell
010301 14:38:23  Aborted connection 854 to db: 'users' user: 'simplebackups'
```
è¿™æ„å‘³ç€å‘ç”Ÿäº†ä»¥ä¸‹æƒ…å†µï¼š

- å®¢æˆ·ç«¯ç¨‹åºæœªè°ƒç”¨mysql_closeï¼ˆï¼‰before é€€å‡ºã€‚
- å®¢æˆ·ç¡å¾—è¶…è¿‡wait_timeoutæˆ–interactive_timeoutæ— éœ€æ‰§è¡Œä»»ä½•è¯·æ±‚ã€‚
- å®¢æˆ·ç«¯ç¨‹åºåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çªç„¶ç»“æŸã€‚
## Canâ€™t create/write to file
```shell
ERROR: Canâ€™t create/write to file
```
å½“ MySQL æ— æ³•åˆ›å»ºæˆ–å†™å…¥æ–‡ä»¶æ—¶ï¼Œé€šå¸¸ä¼šå‘ç”Ÿæ­¤é”™è¯¯ï¼Œé€šå¸¸æ˜¯ç”±äºŽæƒé™ä¸è¶³æˆ–ç£ç›˜ç©ºé—´ä¸è¶³ã€‚
ðŸ’¡ ç¡®ä¿ MySQL ç”¨æˆ·å…·æœ‰å¿…è¦çš„æ–‡ä»¶æƒé™ï¼Œå¹¶æ£€æŸ¥å¯ç”¨ç£ç›˜ç©ºé—´ä»¥è§£å†³æ­¤é—®é¢˜ã€‚
## Commands out of sync
```shell
ERROR: Commands out of sync
```
å¦‚æžœæ‚¨åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­æ”¶åˆ°æ­¤é”™è¯¯ï¼Œåˆ™è¡¨ç¤ºæ‚¨ä»¥é”™è¯¯çš„é¡ºåºè°ƒç”¨å®¢æˆ·ç«¯å‡½æ•°ã€‚
ä¾‹å¦‚ï¼Œå¦‚æžœæ‚¨æ­£åœ¨ä½¿ç”¨mysql_use_resultï¼ˆï¼‰å¹¶å°è¯•åœ¨è°ƒç”¨mysql_free_resultï¼ˆï¼‰.

ðŸ’¡ ç¡®ä¿æ‚¨çš„åº”ç”¨ç¨‹åºéµå¾ªæ­£ç¡®çš„æ‰§è¡Œå’ŒèŽ·å–æŸ¥è¯¢ç»“æžœçš„é¡ºåºï¼Œä»¥é¿å…æ­¤é”™è¯¯ã€‚



## Packet for query is too largeé”™è¯¯
```txt
åœ¨mysqlå®‰è£…ç›®å½•ä¸­æ‰¾åˆ°my.inié…ç½®æ–‡ä»¶
åœ¨æœ€åŽæ·»åŠ  max_allowed_packet=10485760
```
æ•°å€¼å¯ä»¥ MBä¸ºå•ä½ï¼Œ16M


##  ç´¢å¼•å¤±æ•ˆ
egï¼šå‡è®¾ageæ˜¯æ•´æ•°ç±»åž‹ï¼Œä½†æ˜¯å´ä½¿ç”¨å­—ç¬¦ä¸²ç±»åž‹
```shell
SELECT * FROM user WHERE age = '20';
```
MySQL éœ€è¦åœ¨æŸ¥è¯¢æ—¶è½¬æ¢ '20' ä¸ºæ•´æ•°ç±»åž‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç´¢å¼•æ— æ³•ä½¿ç”¨ã€‚ æŸä¸ªç”µå•†å¹³å°å°±æœ‰è¿™ä¹ˆä¸€ä¸ªç±»ä¼¼çš„bugï¼Œå¯¼è‡´ä¸‹å•è¶…æ—¶å´©ç›˜30åˆ†é’Ÿã€‚

## MySql 5.7 è§£å†³GROUP BYå‡ºçŽ°çš„é—®é¢˜
æŠ¥é”™å¦‚ä¸‹ï¼š
```shell
1055 - Expression #1 of SElECT list is not in GRoUp BY clause and contains nonaggregated column 'projhigh.project node.i whicn is not functionally dependent on columns in GROup BY clause; this is incompatible with sql mode=only_full_group_by

```

å¼•èµ·çš„åŽŸå› æ˜¯ï¼šè¿™ä¸ªé”™è¯¯ä¸€èˆ¬å‘ç”Ÿåœ¨mysql 5.7ä»¥åŠ 5.7ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œå…¶åŽŸå› æ˜¯mysqlçš„é»˜è®¤é…ç½®ä¸­,sql_mode="ONLY_FULL_GROUP_BY" è¿™ä¸ªé…ç½®ä¸¥æ ¼æ‰§è¡Œäº† 'SQL92æ ‡å‡†',æ‰€ä»¥å¾ˆé«˜ç½‘ç«™ç»´æŠ¤äººå‘˜åœ¨å‡çº§mysqlç‰ˆæœ¬æ—¶ï¼Œéƒ½ä¼šä¿®æ”¹ sql_mode çš„é…ç½®ï¼Œä½¿å…¶èƒ½å…¼å®¹ã€‚

è§£å†³æ–¹æ³•1ï¼Œé‡å¯mysqlåŽä¼šå¤±æ•ˆï¼š
```shell
-- æŸ¥çœ‹ONLY_FULL_GROUP_BY æ ¡éªŒè§„åˆ™æ˜¯å¦å¼€å¯
SELECT @@GLOBAL.sql_mode;
SELECT @@SESSION.sql_mode;
 
 
-- ç¬¬ä¸€ä¸ªsqlè¯­å¥çš„ç»“æžœï¼Œä½¿ç”¨è‡ªå·±æŸ¥è¯¢çš„ç»“æžœ
ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
 
-- ç¬¬äºŒä¸ªsqlè¯­å¥çš„ç»“æžœ
ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION


-- å…³é—­only_full_group_byçš„è§„åˆ™æ ¡éªŒ
set @@GLOBAL.sql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION';
set @@SESSION.sql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION';
```

è§£å†³æ–¹æ³•2ï¼š
ä¿®æ”¹é…ç½®æ–‡ä»¶ my.ini 
```shell
åœ¨ [mysqld] ä¸‹é¢æ·»åŠ ä»£ç ï¼š
sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION
```

é‡å¯mysqlæœåŠ¡ã€‚

æ³¨æ„ï¼š

1ã€ä¸åŒçš„ç³»ç»Ÿï¼Œmysql çš„é…ç½®æ–‡ä»¶åä»¥åŠè·¯å¾„ä¸åŒ

2ã€Macæˆ–Linuxæ–‡ä»¶  /etc/my.cnf

3ã€windows åœ¨æ•°æ®åº“å®‰è£…ç›®å½•ä¸‹çš„ my.ini



## Lock wait timeout exceeded; try restarting transaction

è¿™æ˜¯ MySQL æ•°æ®åº“ä¸­çš„ä¸€ä¸ªå¸¸è§é”™è¯¯ï¼Œé€šå¸¸å‘ç”Ÿåœ¨ä½¿ç”¨ InnoDB å­˜å‚¨å¼•æ“Žçš„äº‹åŠ¡ä¸­ã€‚å®ƒçš„å«ä¹‰æ˜¯ï¼šæŸä¸ªäº‹åŠ¡åœ¨å°è¯•èŽ·å–é”èµ„æºæ—¶ï¼Œç­‰å¾…æ—¶é—´è¶…è¿‡äº†æ•°æ®åº“é…ç½®çš„é˜ˆå€¼ï¼ˆinnodb_lock_wait_timeoutï¼Œé»˜è®¤ 50 ç§’ï¼‰ï¼Œå› æ­¤è¢«å¼ºåˆ¶ç»ˆæ­¢

## å‚è€ƒ
> https://simplebackups.com/blog/extensive-mysql-common-errors-list/#the-anatomy-of-mysql-errors